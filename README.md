# TelePayroll (refactor)

## Быстрый старт
1. Создай `.env` (см. пример ниже).
2. Установи зависимости: `pip install -e .` или `pip install -r <generated by pip-tools>`
3. Запусти: `python -m telepayroll.app.main`

### .env пример
```
BOT_TOKEN=123456:ABCDEF
ADMIN_IDS=11111111,22222222
DATA_DIR=./data
```

В нужном групповом чате админ даёт команду `/bind_here` — бот запомнит `chat_id` для опросов.
Создать опрос: `/newpoll` (мастер: вопрос → варианты).
Посмотреть итоги последнего опроса: `/payroll`. Кнопками можно добавлять голосовавших в ростер.

## Архитектура
- `app/infra` — БД (`sqlite3`), репозитории.
- `app/domain` — чистая доменная логика (`payroll`).
- `app/services` — use-cases (`PollsService`, `PayrollService`), UI (`payroll_screen_text_and_kb`).
- `app/handlers` — aiogram-хендлеры, FSM для `/newpoll`.
- `app/middlewares` — `ContextInjector` (внедряет AppContext).

## Замечания
- Логирования нет (по требованию). Добавить его можно позже без изменения публичных интерфейсов.
- SQLite в синхронном режиме с короткими транзакциями; при росте нагрузки можно перейти на `aiosqlite`.
